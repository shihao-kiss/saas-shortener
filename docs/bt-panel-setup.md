# 宝塔面板安装指南（CentOS 7）

> 目的：安装宝塔面板作为服务器可视化管理工具，方便查看资源、管理文件和防火墙。
>
> ⚠️ **只装面板本身，不要装它推荐的 LNMP/LAMP 套件**（Nginx、MySQL、PHP 等全部跳过）。
> 本项目的数据库、Redis 等全部运行在 Docker 容器中，装宝塔自带的软件会造成端口冲突。

---

## 一、安装前准备

确认已完成以下步骤（参考 `vmware-setup-guide.md`）：

- [x] CentOS 7 虚拟机已安装完成
- [x] 网络已配通，能从 Windows SSH 连接
- [x] yum 源已配置为阿里云归档源

---

## 二、安装宝塔面板

### 2.1 执行安装脚本

```bash
yum install -y wget && wget -O install.sh https://download.bt.cn/install/install_6.0.sh && sh install.sh ed8484bec
```

安装过程中提示 `Do you want to install Bt-Panel to the /www directory now?(y/n)`，输入 **y** 回车。

等待约 2-3 分钟，安装完成后会显示：

```
==================================================================
外网面板地址: http://xxx.xxx.xxx.xxx:8888/xxxxxxxx
内网面板地址: http://192.168.110.xxx:8888/xxxxxxxx
username: xxxxxxxx
password: xxxxxxxx
==================================================================
```

**⚠️ 请立即记下用户名和密码！** 之后找回比较麻烦。

### 2.2 开放防火墙端口

```bash
# 放行宝塔面板端口
sudo firewall-cmd --permanent --add-port=8888/tcp
sudo firewall-cmd --reload

# 验证
sudo firewall-cmd --list-ports
# 应包含 8888/tcp
```

### 2.3 访问面板

在 Windows 浏览器中打开安装完成时显示的内网面板地址：

```
http://192.168.110.xxx:8888/xxxxxxxx
```

输入安装时给出的用户名和密码登录。

---

## 三、首次登录配置

### 3.1 跳过软件推荐安装

登录后会弹出**推荐安装套件**的对话框，**直接关掉，一个都不要装**：

| 宝塔推荐 | 操作 | 原因 |
|----------|------|------|
| Nginx | **不装** | 项目通过 Docker 暴露端口，不需要额外的反向代理 |
| MySQL | **不装** | 项目使用 Docker 中的 PostgreSQL |
| PHP | **不装** | Go 项目不需要 PHP |
| phpMyAdmin | **不装** | 不使用 MySQL |
| Redis | **不装** | 项目使用 Docker 中的 Redis |

### 3.2 绑定账号（可选）

宝塔会提示绑定宝塔官网账号，可以选择绑定也可以跳过。学习环境跳过即可。

---

## 四、宝塔面板的用途

在本项目中，宝塔面板主要用作轻量管理工具：

### 4.1 服务器监控

面板首页可以实时查看：
- CPU 使用率
- 内存使用率
- 磁盘使用率
- 网络流量

### 4.2 文件管理

左侧菜单 → **文件**：
- 可视化浏览服务器文件
- 上传/下载文件（比 scp 方便）
- 在线编辑文件
- 项目代码位于 `/home/dev/saas-shortener/`

### 4.3 终端

左侧菜单 → **终端**：
- 自带 Web 终端，不用单独开 SSH 客户端
- 可以直接在浏览器里执行命令

### 4.4 防火墙管理

左侧菜单 → **安全**：
- 可视化管理防火墙端口
- 比命令行 `firewall-cmd` 更直观
- 本项目需要开放的端口：

| 端口 | 用途 |
|------|------|
| 22 | SSH |
| 8080 | SaaS 短链接服务 |
| 9090 | Prometheus 监控 |
| 3000 | Grafana 可视化 |
| 8888 | 宝塔面板 |

### 4.5 Docker 管理（需安装插件）

左侧菜单 → **Docker**：
- 宝塔自带 Docker 管理界面
- 可以可视化查看容器、镜像、网络、卷
- 如果提示安装 Docker 插件，可以装（只是面板插件，不会影响已有的 Docker）

---

## 五、常用命令

```bash
# 查看面板信息（忘记用户名密码时用）
sudo bt default

# 重置面板密码
sudo bt 5

# 修改面板端口
sudo bt 8

# 重启面板
sudo bt restart

# 停止面板
sudo bt stop

# 启动面板
sudo bt start

# 查看面板状态
sudo bt status
```

---

## 六、安全建议

学习环境可以不用太在意，但养成好习惯：

1. **修改默认端口**：8888 是公认的宝塔端口，容易被扫描
   ```bash
   sudo bt 8
   # 输入新端口号，如 12345
   ```

2. **修改默认用户名和密码**：
   - 面板 → 设置 → 面板用户 / 面板密码

3. **绑定访问 IP**（可选）：
   - 面板 → 设置 → 面板 IP → 填写你 Windows 宿主机的 VMnet8 IP
   - 这样只有宿主机能访问面板

---

## 七、资源占用

| 组件 | 内存占用 | 说明 |
|------|---------|------|
| 宝塔面板 | ~100-200MB | 仅面板服务（不装任何套件） |
| 8GB 虚拟机剩余 | ~6GB+ | 完全够用 |

不装 LNMP/LAMP 套件的情况下，宝塔面板对系统资源的影响很小。
